/*
 *  Description     : BTree Index verification (usage) test
 *                  : This test is intended to verify that the primary BTree index is used 
 *                  : in the optimized query plan for predicates like (predicate1 and predicate2 and predicate3 and predicate4).
 *  Expected Result : Success
 *  Date            : 13th Aug 2012
 */

drop dataverse test if exists;
create dataverse test;
use dataverse test;

write output to nc1:"rttest/btree-index_btree-primary-19.adm";

create type TestType as open {
    fname : string,
    lname : string
}

// create internal dataset with primary index defined on fname,lname fields
create dataset testdst(TestType) partitioned by key fname,lname;

// load valid data with fname and lname entries

load dataset testdst
using "edu.uci.ics.asterix.external.dataset.adapter.NCFileSystemAdapter"
(("path"="nc1://data/fn-ln.adm"),("format"="delimited-text"),("delimiter"="|"));

// Query the data that was loaded above. 

for $emp in dataset('testdst') 
where $emp.fname > "Craig" and $emp.lname > "Kevin" and $emp.fname <= "Mary" and $emp.lname <= "Tomes"
return $emp
