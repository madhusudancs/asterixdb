/*
 * Description    : Tests that max aggregation correctly returns null for an empty stream,
 *                  with an aggregate combiner.
 * Success        : Yes
 */

drop dataverse test if exists;
create dataverse test;
use dataverse test;

create type TestType as closed {
  id: int32,
  val: double
}

create dataset Test(TestType) partitioned by key id;

write output to nc1:"rttest/aggregate_max_empty_02.adm";

max(
 for $x in dataset('Test')
 return $x.val
)