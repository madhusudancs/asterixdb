drop dataverse test if exists;
create dataverse test;
use dataverse test;

create type Tweet as closed {
        id: int32,
        tweetid: int64,
        loc: point,
        time: datetime,
        text: string
}

create dataset TwitterData(Tweet)
  partitioned by key id;

load dataset TwitterData 
using "edu.uci.ics.asterix.external.dataset.adapter.NCFileSystemAdapter"
(("path"="nc1://data/twitter/smalltweets.txt"),("format"="adm")) pre-sorted;
write output to nc1:"rttest/comparison_datetime_range.adm";

for $t in dataset('TwitterData')
where $t.time > datetime("2011-05-15T16:00:00Z") and $t.time < datetime("2011-05-15T21:59:59Z")
order by $t.id
return { "id": $t.id }
