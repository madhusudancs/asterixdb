/* 
 * Test case Name  : open-closed-02.aql
 * Description     : This test is intended to test insertion of additional data into a dataset of closed type 
 * Expected Result : This test should fail because closed type internal datasets can not ingest additional data.
 * 
 */

drop dataverse test if exists;

create dataverse test;

use dataverse test;

// name field here is optional.
create type testType as closed {
id : int32,
name : string?
}

create dataset testds(testType) partitioned by key id;

insert into dataset testds({"id": 123});

write output to nc1:"rttest/open-closed_open-closed-02.adm";
for $l in dataset("testds") return $l
