/*
 * Testcase name : open-closed-14.aql
 * Description   : insert into target dataset - select * from source dataset
 *               : in this case dataset1 and dataset2 are fo different schema.
 * Success       : This test should succeed.
 * Date          : March 27 2012
 */

drop dataverse testdv2 if exists;
create dataverse testdv2;
use dataverse testdv2;

create type testtype01 as closed {
  id: string,
  name: string?
}

create type testtype02 as closed {
  id: string  
}

create dataset testds01(testtype01) partitioned by key id;

create dataset testds02(testtype02) partitioned by key id;

insert into dataset testds01 (
{ "id": "001" }
);

insert into dataset testds01 (
{ "id": "002", "name": "John Doe" }
);

insert into dataset testds02 (
{ "id": "003" }
);

insert into dataset testds02 (
{ "id": "004" }
);

insert into dataset testds02 (
{ "id": "005" }
);

insert into dataset testds01(
for $d in dataset("testds02")
return $d
);

for $d in dataset("testds01")
return $d

