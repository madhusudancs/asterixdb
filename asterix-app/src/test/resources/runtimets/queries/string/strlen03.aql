/*
 * Description    : Test string-length(string) function 
 * Expected Res   : Success
 * Date           : 19th April 2012
 */


// Create internal dataset, insert string data and pass the string attribute to string-length function, and verify results.

drop dataverse test if exists;
create dataverse test;
use dataverse test;

create type TestType as {
name:string
}

create dataset testds(TestType) partitioned by key name;

insert into dataset testds({"name":"Maradona"});
insert into dataset testds({"name":"Pele"});
insert into dataset testds({"name":"Roberto Baggio"});
insert into dataset testds({"name":"Beckham David"});
insert into dataset testds({"name":"Rooney"});
insert into dataset testds({"name":"Ronaldinho"});
insert into dataset testds({"name":"Ronaldo"});
insert into dataset testds({"name":"Zinadine Zidane"});
insert into dataset testds({"name":"Cristiano Ronaldo"});
insert into dataset testds({"name":"Messi"});
insert into dataset testds({"name":"Tevez"});
insert into dataset testds({"name":"Henry"});

write output to nc1:"rttest/string_strlen03.adm";

for $l in dataset('testds')
order by $l.name
return string-length($l.name)
