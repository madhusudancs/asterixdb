/*
 * Description  : Create two dataverses and one dataset in each of the dataverse
 *              : insert data and query using the datasets using fully qualified names and return results.
 * Expected Res : Success
 * Date         : Sep 7th 2012
 * Ignored      : Not part of the current test build because of Issue 199
 */


drop dataverse test if exists;
drop dataverse fest if exists;

create dataverse test;
create dataverse fest;

create type test.testtype as open {
id : int32
}

create type fest.testtype as open {
id : int32
}

create dataset test.t1(testtype) partitioned by key id;
create dataset fest.t1(testtype) partitioned by key id;

insert into dataset test.t1({"id":24});
insert into dataset test.t1({"id":23});
insert into dataset test.t1({"id":21});
insert into dataset test.t1({"id":44});
insert into dataset test.t1({"id":64});

insert into dataset fest.t1({"id":24});
insert into dataset fest.t1({"id":23});
insert into dataset fest.t1({"id":21});
insert into dataset fest.t1({"id":44});
insert into dataset fest.t1({"id":64});

let $a := (for $l in dataset('fest.t1') return $l)
let $b := (for $m in dataset('test.t1') return $m)
return {"a":$a,"b":$b}
