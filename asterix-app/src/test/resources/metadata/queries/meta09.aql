/*
 * Description  : Create internal dataset, insert data and query metadata Dataset to verify entries for that dataset.
 * Expected Res : Success
 * Date         : Sep 17 2012
 */

drop dataverse test if exists;
create dataverse test;

write output to nc1:"rttest/meta09.adm";

create type test.testtype as open {
id:int32
}

create dataset test.t1(testtype) partitioned by key id;

insert into dataset test.t1({"id":123});
insert into dataset test.t1({"id":133});
insert into dataset test.t1({"id":223});
insert into dataset test.t1({"id":127});
insert into dataset test.t1({"id":423});
insert into dataset test.t1({"id":183});
insert into dataset test.t1({"id":193});
insert into dataset test.t1({"id":129});
insert into dataset test.t1({"id":373});
insert into dataset test.t1({"id":282});

for $l in dataset('Metadata.Dataset')
where $l.DataverseName='test' and $l.DatasetName='t1'
return $l
